<!DOCTYPE html>
<html lang="en-us">
<head>
  <link rel="preload" href="/lib/font-awesome/webfonts/fa-brands-400.woff2" as="font" type="font/woff2" crossorigin="anonymous">
  <link rel="preload" href="/lib/font-awesome/webfonts/fa-regular-400.woff2" as="font" type="font/woff2" crossorigin="anonymous">
  <link rel="preload" href="/lib/font-awesome/webfonts/fa-solid-900.woff2" as="font" type="font/woff2" crossorigin="anonymous">
  <link rel="preload" href="/lib/JetBrainsMono/web/woff2/JetBrainsMono-Regular.woff2" as="font" type="font/woff2" crossorigin="anonymous">
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title> Java 并发知识大纲 | Y.CH.Y</title>
  <link rel = 'canonical' href = '/notes/java_concurrency/'>
  
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="robots" content="all,follow">
  <meta name="googlebot" content="index,follow,snippet,archive">
  <meta property="og:title" content="Java 并发知识大纲" />
<meta property="og:description" content="实现多线程 继承 Thread 类，重写 run 方法 class Demo extends Thread { @Override public void run() { System.out.println(&#34;implements thread via thread class&#34;); } } 实现 Runnable 接口，并把 Runnable 对象传给 Thread 类 class Demo implements Runnable { @Override public void run() { System.out.println(&#34;implements thread via runnable interface&#34;); } } 对比 实现 Runnable 更好，解耦方法实现，可以节省资源，利用线程池，无需与 Thread 类的创建销毁绑定，Thread 有单继承限制。
本质 /** * If this thread was constructed using a separate * {@code Runnable} run object, then that * {@code Runnable} object&#39;s {@code run} method is called; * otherwise, this method does nothing and returns." />
<meta property="og:type" content="article" />
<meta property="og:url" content="/notes/java_concurrency/" /><meta property="article:section" content="notes" />
<meta property="article:published_time" content="2021-09-03T22:16:38+08:00" />
<meta property="article:modified_time" content="2021-09-03T22:16:38+08:00" />


  <meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="Java 并发知识大纲"/>
<meta name="twitter:description" content="实现多线程 继承 Thread 类，重写 run 方法 class Demo extends Thread { @Override public void run() { System.out.println(&#34;implements thread via thread class&#34;); } } 实现 Runnable 接口，并把 Runnable 对象传给 Thread 类 class Demo implements Runnable { @Override public void run() { System.out.println(&#34;implements thread via runnable interface&#34;); } } 对比 实现 Runnable 更好，解耦方法实现，可以节省资源，利用线程池，无需与 Thread 类的创建销毁绑定，Thread 有单继承限制。
本质 /** * If this thread was constructed using a separate * {@code Runnable} run object, then that * {@code Runnable} object&#39;s {@code run} method is called; * otherwise, this method does nothing and returns."/>

  
  
    
  
  
  <link rel="stylesheet" href="/css/styles.c61fc3c2ee4a9b16e496ebbd00aca64c62a3fb9690445e8bb87400c69fdb11a46ed08f463cc2ce7eb743c7d462f0d6ff89e2d1c281c1860e9e6204ab85ddb79d.css" integrity="sha512-xh/Dwu5Kmxbkluu9AKymTGKj&#43;5aQRF6LuHQAxp/bEaRu0I9GPMLOfrdDx9Ri8Nb/ieLRwoHBhg6eYgSrhd23nQ=="> 

  
  
  
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
      <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
  

  
<link rel="icon" type="image/png" href="/images/favicon.ico" />

  
  
  
  
  
    
<script type="application/javascript">
var doNotTrack = false;
if (!doNotTrack) {
	window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;
	ga('create', 'G-X1L70M4MM0', 'auto');
	
	ga('send', 'pageview');
}
</script>
<script async src='https://www.google-analytics.com/analytics.js'></script>

  
  
</head>

<body class="max-width mx-auto px3 ltr">
  <div class="content index py4">

    <header id="header">
  <a href="/">
  
    <div id="logo" style="background-image: url(/images/logo.png)"></div>
  
  <div id="title">
    <h1>Y.CH.Y</h1>
  </div>
  </a>
  <div id="nav">
    <ul>
      <li class="icon">
        <a href="#" aria-label="Menu"><i class="fas fa-bars fa-2x" aria-hidden="true"></i></a>
      </li>
      
        <li><a href="/">首页</a></li>
      
        <li><a href="/algorithm">算法</a></li>
      
        <li><a href="/about">关于</a></li>
      
    </ul>
  </div>
</header>



    
<article class="post" itemscope itemtype="http://schema.org/BlogPosting">

  <div class="content" itemprop="articleBody">
  
    <h2 id="实现多线程">实现多线程</h2>
<h3 id="继承-thread-类重写-run-方法">继承 Thread 类，重写 run 方法</h3>
<div class="highlight"><pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-java" data-lang="java"><span style="color:#00a8c8">class</span> <span style="color:#75af00">Demo</span> <span style="color:#00a8c8">extends</span> <span style="color:#111">Thread</span> <span style="color:#f92672">{</span>

    <span style="color:#75af00">@Override</span>
    <span style="color:#00a8c8">public</span> <span style="color:#00a8c8">void</span> <span style="color:#75af00">run</span><span style="color:#f92672">()</span> <span style="color:#f92672">{</span>
        <span style="color:#111">System</span><span style="color:#f92672">.</span><span style="color:#75af00">out</span><span style="color:#f92672">.</span><span style="color:#75af00">println</span><span style="color:#f92672">(</span><span style="color:#d88200">&#34;implements thread via thread class&#34;</span><span style="color:#f92672">);</span>
    <span style="color:#f92672">}</span>
<span style="color:#f92672">}</span>
</code></pre></div><h3 id="实现-runnable-接口并把-runnable-对象传给-thread-类">实现 Runnable 接口，并把 Runnable 对象传给 Thread 类</h3>
<div class="highlight"><pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-java" data-lang="java"><span style="color:#00a8c8">class</span> <span style="color:#75af00">Demo</span> <span style="color:#00a8c8">implements</span> <span style="color:#111">Runnable</span> <span style="color:#f92672">{</span>

    <span style="color:#75af00">@Override</span>
    <span style="color:#00a8c8">public</span> <span style="color:#00a8c8">void</span> <span style="color:#75af00">run</span><span style="color:#f92672">()</span> <span style="color:#f92672">{</span>
        <span style="color:#111">System</span><span style="color:#f92672">.</span><span style="color:#75af00">out</span><span style="color:#f92672">.</span><span style="color:#75af00">println</span><span style="color:#f92672">(</span><span style="color:#d88200">&#34;implements thread via runnable interface&#34;</span><span style="color:#f92672">);</span>
    <span style="color:#f92672">}</span>
<span style="color:#f92672">}</span>
</code></pre></div><h3 id="对比">对比</h3>
<p>实现 Runnable 更好，解耦方法实现，可以节省资源，利用线程池，无需与 Thread 类的创建销毁绑定，Thread 有单继承限制。</p>
<h3 id="本质">本质</h3>
<div class="highlight"><pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-java" data-lang="java">
    <span style="color:#75715e">/**
</span><span style="color:#75715e">     * If this thread was constructed using a separate
</span><span style="color:#75715e">     * {@code Runnable} run object, then that
</span><span style="color:#75715e">     * {@code Runnable} object&#39;s {@code run} method is called;
</span><span style="color:#75715e">     * otherwise, this method does nothing and returns.
</span><span style="color:#75715e">     * &lt;p&gt;
</span><span style="color:#75715e">     * Subclasses of {@code Thread} should override this method.
</span><span style="color:#75715e">     *
</span><span style="color:#75715e">     * @see     #start()
</span><span style="color:#75715e">     * @see     #stop()
</span><span style="color:#75715e">     * @see     #Thread(ThreadGroup, Runnable, String)
</span><span style="color:#75715e">     */</span>
    <span style="color:#75af00">@Override</span>
    <span style="color:#00a8c8">public</span> <span style="color:#00a8c8">void</span> <span style="color:#75af00">run</span><span style="color:#f92672">()</span> <span style="color:#f92672">{</span>
        <span style="color:#00a8c8">if</span> <span style="color:#f92672">(</span><span style="color:#111">target</span> <span style="color:#f92672">!=</span> <span style="color:#00a8c8">null</span><span style="color:#f92672">)</span> <span style="color:#f92672">{</span>
            <span style="color:#111">target</span><span style="color:#f92672">.</span><span style="color:#75af00">run</span><span style="color:#f92672">();</span>
        <span style="color:#f92672">}</span>
    <span style="color:#f92672">}</span>
</code></pre></div><p>最终调用<code>targe.run()</code>方法</p>
<p>重写<code>run()</code>方法</p>
<h3 id="同时传入-runnable-对象和重写-thread-的-run-方法">同时传入 Runnable 对象和重写 Thread 的 run 方法</h3>
<div class="highlight"><pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-java" data-lang="java"><span style="color:#00a8c8">public</span> <span style="color:#00a8c8">class</span> <span style="color:#75af00">Main</span> <span style="color:#00a8c8">extends</span> <span style="color:#111">Thread</span> <span style="color:#00a8c8">implements</span> <span style="color:#111">Runnable</span> <span style="color:#f92672">{</span>

    <span style="color:#00a8c8">public</span> <span style="color:#00a8c8">static</span> <span style="color:#00a8c8">void</span> <span style="color:#75af00">main</span><span style="color:#f92672">(</span><span style="color:#111">String</span><span style="color:#f92672">[]</span> <span style="color:#111">args</span><span style="color:#f92672">)</span> <span style="color:#00a8c8">throws</span> <span style="color:#111">InterruptedException</span> <span style="color:#f92672">{</span>
        <span style="color:#111">Thread</span> <span style="color:#111">t</span> <span style="color:#f92672">=</span> <span style="color:#00a8c8">new</span> <span style="color:#111">Thread</span><span style="color:#f92672">(()</span> <span style="color:#f92672">-&gt;</span> <span style="color:#f92672">{</span>
            <span style="color:#111">System</span><span style="color:#f92672">.</span><span style="color:#75af00">out</span><span style="color:#f92672">.</span><span style="color:#75af00">println</span><span style="color:#f92672">(</span><span style="color:#d88200">&#34;Runnable&#34;</span><span style="color:#f92672">);</span>
        <span style="color:#f92672">})</span> <span style="color:#f92672">{</span>
            <span style="color:#75af00">@Override</span>
            <span style="color:#00a8c8">public</span> <span style="color:#00a8c8">void</span> <span style="color:#75af00">run</span><span style="color:#f92672">()</span> <span style="color:#f92672">{</span>
                <span style="color:#111">System</span><span style="color:#f92672">.</span><span style="color:#75af00">out</span><span style="color:#f92672">.</span><span style="color:#75af00">println</span><span style="color:#f92672">(</span><span style="color:#d88200">&#34;Thread&#34;</span><span style="color:#f92672">);</span>
            <span style="color:#f92672">}</span>
        <span style="color:#f92672">};</span>
        <span style="color:#111">t</span><span style="color:#f92672">.</span><span style="color:#75af00">start</span><span style="color:#f92672">();</span>
        <span style="color:#111">t</span><span style="color:#f92672">.</span><span style="color:#75af00">join</span><span style="color:#f92672">();</span>
    <span style="color:#f92672">}</span>
    <span style="color:#75715e">// output: Thread
</span></code></pre></div><h3 id="线程池创建线程">线程池创建线程</h3>
<p>最终通过 Thread 传入 Runnable 来创建线程</p>
<h3 id="通过-callable-和-futuretask-创建线程">通过 Callable 和 FutureTask 创建线程</h3>
<p><img src="https://i.imgur.com/iu91TkG.png" alt="FutureTask"></p>
<p>FutureTask 通过实现了 Ruannbel 接口创建线程</p>
<h3 id="定时器-timer">定时器 Timer</h3>
<p>Timer 通过传入 TimerTask 实现多线程，TimerTask 本质上继承了 Runnable 接口</p>
<div class="highlight"><pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-java" data-lang="java">
<span style="color:#00a8c8">public</span> <span style="color:#00a8c8">abstract</span> <span style="color:#00a8c8">class</span> <span style="color:#75af00">TimerTask</span> <span style="color:#00a8c8">implements</span> <span style="color:#111">Runnable</span> <span style="color:#f92672">{</span>
    <span style="color:#75715e">//...
</span><span style="color:#75715e"></span><span style="color:#f92672">}</span>

</code></pre></div><h3 id="匿名内部类和-lambda-表达式">匿名内部类和 Lambda 表达式</h3>
<p>本质上都是通过传入 Thread 传入 Runnable 对象</p>
<div class="highlight"><pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-java" data-lang="java"><span style="color:#00a8c8">public</span> <span style="color:#00a8c8">class</span> <span style="color:#75af00">Main</span>  <span style="color:#f92672">{</span>
    <span style="color:#00a8c8">public</span> <span style="color:#00a8c8">static</span> <span style="color:#00a8c8">void</span> <span style="color:#75af00">main</span><span style="color:#f92672">(</span><span style="color:#111">String</span><span style="color:#f92672">[]</span> <span style="color:#111">args</span><span style="color:#f92672">){</span>
        <span style="color:#00a8c8">new</span> <span style="color:#111">Thread</span><span style="color:#f92672">(</span><span style="color:#00a8c8">new</span> <span style="color:#111">Runnable</span><span style="color:#f92672">()</span> <span style="color:#f92672">{</span>
            <span style="color:#75af00">@Override</span>
            <span style="color:#00a8c8">public</span> <span style="color:#00a8c8">void</span> <span style="color:#75af00">run</span><span style="color:#f92672">()</span> <span style="color:#f92672">{</span>
                <span style="color:#111">System</span><span style="color:#f92672">.</span><span style="color:#75af00">out</span><span style="color:#f92672">.</span><span style="color:#75af00">println</span><span style="color:#f92672">(</span><span style="color:#d88200">&#34;anonymous inner class&#34;</span><span style="color:#f92672">);</span>
            <span style="color:#f92672">}</span>
        <span style="color:#f92672">}).</span><span style="color:#75af00">start</span><span style="color:#f92672">();</span>

        <span style="color:#00a8c8">new</span> <span style="color:#111">Thread</span><span style="color:#f92672">(()</span> <span style="color:#f92672">-&gt;</span> <span style="color:#f92672">{</span>
            <span style="color:#111">System</span><span style="color:#f92672">.</span><span style="color:#75af00">out</span><span style="color:#f92672">.</span><span style="color:#75af00">println</span><span style="color:#f92672">(</span><span style="color:#d88200">&#34;lambda expression&#34;</span><span style="color:#f92672">);</span>
        <span style="color:#f92672">}).</span><span style="color:#75af00">start</span><span style="color:#f92672">();</span>
    <span style="color:#f92672">}</span>
<span style="color:#f92672">}</span>

</code></pre></div><h2 id="启动线程的方法">启动线程的方法</h2>
<h3 id="start方法的含义"><code>start()</code>方法的含义</h3>
<div class="highlight"><pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-java" data-lang="java"><span style="color:#00a8c8">public</span> <span style="color:#00a8c8">class</span> <span style="color:#75af00">Main</span> <span style="color:#f92672">{</span>
    <span style="color:#00a8c8">public</span> <span style="color:#00a8c8">static</span> <span style="color:#00a8c8">void</span> <span style="color:#75af00">main</span><span style="color:#f92672">(</span><span style="color:#111">String</span><span style="color:#f92672">[]</span> <span style="color:#111">args</span><span style="color:#f92672">)</span> <span style="color:#f92672">{</span>
        <span style="color:#00a8c8">new</span> <span style="color:#111">Thread</span><span style="color:#f92672">(()-&gt;{</span>
            <span style="color:#111">System</span><span style="color:#f92672">.</span><span style="color:#75af00">out</span><span style="color:#f92672">.</span><span style="color:#75af00">println</span><span style="color:#f92672">(</span><span style="color:#d88200">&#34;RUN&#34;</span><span style="color:#f92672">);</span>
        <span style="color:#f92672">}).</span><span style="color:#75af00">start</span><span style="color:#f92672">();</span>
    <span style="color:#f92672">}</span>
<span style="color:#f92672">}</span>
</code></pre></div><p>调用<code>start()</code>方法通知 JVM 有资源时启动新线程</p>
<p>不能重复执行<code>start()</code>方法，启动新线程时检查线程状态，加入新线程，调用<code>start0()</code>方法</p>
<h3 id="run方法的含义"><code>run()</code>方法的含义</h3>
<p>在主线程中直接执行 Runnable 的<code>run()</code>方法，相当于执行一个普通方法</p>
<p>在 Thread 类中执行调用<code>start()</code>方法，再由<code>start()</code>方法调用<code>run()</code>方法，从而创建多线程</p>
<h3 id="停止线程">停止线程</h3>
<h2 id="线程状态">线程状态</h2>
<h2 id="thread-和-object-类中和线程相关的重要方法">Thread 和 Object 类中和线程相关的重要方法</h2>
<h2 id="线程属性">线程属性</h2>
<h2 id="线程的未捕获异常-uncaughtexception-处理">线程的未捕获异常 UncaughtException 处理</h2>
<h2 id="线程的问题">线程的问题</h2>
<h2 id="常见面试题">常见面试题</h2>

  
  </div>
</article>


    <footer id="footer">
  <script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.2/MathJax.js?config=TeX-MML-AM_SVG"></script>
  <div class="footer-left">
    Copyright  &copy; 2021  Y.CH.Y 
    
    
  </div>
  <div class="footer-right">
    <nav>
      <ul>
         
        <li><a href="/">首页</a></li>
         
        <li><a href="/algorithm">算法</a></li>
         
        <li><a href="/about">关于</a></li>
        
      </ul>
    </nav>
  </div>
</footer>


  </div>
</body>

<link rel="stylesheet" href=/lib/font-awesome/css/all.min.css>
<script src=/lib/jquery/jquery.min.js></script>
<script src=/js/main.js></script>
</html>
