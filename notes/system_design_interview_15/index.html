<!DOCTYPE html>
<html lang="en-us">
<head>
  <link rel="preload" href="/lib/font-awesome/webfonts/fa-brands-400.woff2" as="font" type="font/woff2" crossorigin="anonymous">
  <link rel="preload" href="/lib/font-awesome/webfonts/fa-regular-400.woff2" as="font" type="font/woff2" crossorigin="anonymous">
  <link rel="preload" href="/lib/font-awesome/webfonts/fa-solid-900.woff2" as="font" type="font/woff2" crossorigin="anonymous">
  <link rel="preload" href="/lib/JetBrainsMono/web/woff2/JetBrainsMono-Regular.woff2" as="font" type="font/woff2" crossorigin="anonymous">
  <link rel="apple-touch-icon" href="/images/apple-touch-icon.png" />
  <link rel="apple-touch-icon" sizes="57x57" href="/images/apple-touch-icon-57x57.png" />
  <link rel="apple-touch-icon" sizes="72x72" href="/images/apple-touch-icon-72x72.png" />
  <link rel="apple-touch-icon" sizes="76x76" href="/images/apple-touch-icon-76x76.png" />
  <link rel="apple-touch-icon" sizes="114x114" href="/images/apple-touch-icon-114x114.png" />
  <link rel="apple-touch-icon" sizes="120x120" href="/images/apple-touch-icon-120x120.png" />
  <link rel="apple-touch-icon" sizes="144x144" href="/images/apple-touch-icon-144x144.png" />
  <link rel="apple-touch-icon" sizes="152x152" href="/images/apple-touch-icon-152x152.png" />
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-180x180.png" />
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title> 系统设计::设计谷歌硬盘 | Y.CH.Y</title>
  <link rel = 'canonical' href = '/notes/system_design_interview_15/'>
  
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="robots" content="all,follow">
  <meta name="googlebot" content="index,follow,snippet,archive">
  <meta property="og:title" content="系统设计::设计谷歌硬盘" />
<meta property="og:description" content="设计谷歌硬盘 近年来，Google Drive、Dropbox、微软 OneDrive 和苹果 iCloud 等云存储服务已经变得非常流行。在本章中，你被要求设计 Google Drive。
在进入设计之前，让我们花点时间来了解一下 Google Drive。Google Drive 是一个文件存储和同步服务，帮助你在云端存储文档、照片、视频和其他文件。你可以从任何电脑、智能手机和平板电脑访问你的文件。你可以轻松地与朋友、家人和同事分享这些文件[1]。图 15-1 和 15-2 分别显示了谷歌硬盘在浏览器和移动应用程序上的样子。
理解问题并确定设计范围 设计谷歌硬盘是一个大项目，因此，提出问题以缩小范围是很重要的。
应聘者：最重要的功能是什么？
面试官：上传和下载文件，文件同步，以及通知。
应聘者：这是一个移动应用，一个网络应用，还是两者都有？
面试官：都是。
应聘者：支持的文件格式有哪些？
面试官：任何文件类型。
应聘者：文件是否需要加密？
面试官：是的。是的，存储中的文件必须是加密的。
应聘者：文件大小有限制吗？
面试官：有，文件必须是 10GB 或更小。
应聘者：该产品有多少用户？
面试官：10M DAU。
在本章中，我们将重点介绍以下功能。
 添加文件。添加文件的最简单方法是将文件拖放到 Google Drive 中。 下载文件。 在多个设备上同步文件。当一个文件被添加到一个设备上时，它将自动同步到其他设备。 查看文件修订情况。 与你的朋友、家人和同事分享文件 当一个文件被编辑、删除或与你分享时，发送通知。本章未讨论的功能包括。 谷歌文档的编辑和协作。Google doc 允许多个人同时编辑同一个文件。这不在我们的设计范围之内。  除了澄清需求之外，了解非功能需求也很重要。
 可靠性。可靠性对于一个存储系统是极其重要的。数据丢失是不可接受的。 快速的同步速度。如果文件同步需要太多时间，用户会变得不耐烦并放弃该产品。 带宽使用。如果一个产品需要大量不必要的网络带宽，用户就会不高兴，特别是当他们使用移动数据计划时。 可扩展性。系统应该能够处理大量的流量。 高可用性。当一些服务器离线、速度减慢或出现意外的网络错误时，用户仍应能使用该系统。  粗略估计  假设该应用程序有 5000 万注册用户和 1000 万 DAU。 用户得到 10GB 的免费空间。 假设用户每天上传 2 个文件。平均文件大小为 500KB。 读写比为 1:1。 分配的总空间。5000 万 * 10 GB = 500 Petabyte 上传 API 的 QPS：1000 万 * 2 峰值 QPS = QPS * 2 = 480  提出高水平的设计并获得认同 我们不从一开始就展示高层次的设计图，而是采用一种稍微不同的方法。我们将从简单的东西开始：在一个单一的服务器中建立所有的东西。然后，逐渐扩大规模，支持数百万用户。通过做这个练习，它将刷新你对书中涉及的一些重要话题的记忆。" />
<meta property="og:type" content="article" />
<meta property="og:url" content="/notes/system_design_interview_15/" /><meta property="article:section" content="notes" />
<meta property="article:published_time" content="2021-02-15T22:20:24+08:00" />
<meta property="article:modified_time" content="2021-02-15T22:20:24+08:00" />


  <meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="系统设计::设计谷歌硬盘"/>
<meta name="twitter:description" content="设计谷歌硬盘 近年来，Google Drive、Dropbox、微软 OneDrive 和苹果 iCloud 等云存储服务已经变得非常流行。在本章中，你被要求设计 Google Drive。
在进入设计之前，让我们花点时间来了解一下 Google Drive。Google Drive 是一个文件存储和同步服务，帮助你在云端存储文档、照片、视频和其他文件。你可以从任何电脑、智能手机和平板电脑访问你的文件。你可以轻松地与朋友、家人和同事分享这些文件[1]。图 15-1 和 15-2 分别显示了谷歌硬盘在浏览器和移动应用程序上的样子。
理解问题并确定设计范围 设计谷歌硬盘是一个大项目，因此，提出问题以缩小范围是很重要的。
应聘者：最重要的功能是什么？
面试官：上传和下载文件，文件同步，以及通知。
应聘者：这是一个移动应用，一个网络应用，还是两者都有？
面试官：都是。
应聘者：支持的文件格式有哪些？
面试官：任何文件类型。
应聘者：文件是否需要加密？
面试官：是的。是的，存储中的文件必须是加密的。
应聘者：文件大小有限制吗？
面试官：有，文件必须是 10GB 或更小。
应聘者：该产品有多少用户？
面试官：10M DAU。
在本章中，我们将重点介绍以下功能。
 添加文件。添加文件的最简单方法是将文件拖放到 Google Drive 中。 下载文件。 在多个设备上同步文件。当一个文件被添加到一个设备上时，它将自动同步到其他设备。 查看文件修订情况。 与你的朋友、家人和同事分享文件 当一个文件被编辑、删除或与你分享时，发送通知。本章未讨论的功能包括。 谷歌文档的编辑和协作。Google doc 允许多个人同时编辑同一个文件。这不在我们的设计范围之内。  除了澄清需求之外，了解非功能需求也很重要。
 可靠性。可靠性对于一个存储系统是极其重要的。数据丢失是不可接受的。 快速的同步速度。如果文件同步需要太多时间，用户会变得不耐烦并放弃该产品。 带宽使用。如果一个产品需要大量不必要的网络带宽，用户就会不高兴，特别是当他们使用移动数据计划时。 可扩展性。系统应该能够处理大量的流量。 高可用性。当一些服务器离线、速度减慢或出现意外的网络错误时，用户仍应能使用该系统。  粗略估计  假设该应用程序有 5000 万注册用户和 1000 万 DAU。 用户得到 10GB 的免费空间。 假设用户每天上传 2 个文件。平均文件大小为 500KB。 读写比为 1:1。 分配的总空间。5000 万 * 10 GB = 500 Petabyte 上传 API 的 QPS：1000 万 * 2 峰值 QPS = QPS * 2 = 480  提出高水平的设计并获得认同 我们不从一开始就展示高层次的设计图，而是采用一种稍微不同的方法。我们将从简单的东西开始：在一个单一的服务器中建立所有的东西。然后，逐渐扩大规模，支持数百万用户。通过做这个练习，它将刷新你对书中涉及的一些重要话题的记忆。"/>

  
  
    
  
  
  <link rel="stylesheet" href="/css/styles.20cb878556a53172b1f739e74d6448e277ae5ec41522e72c81c89bc650fdacdaef799e661d0884b057ae4ce2f9972d342f5685db432a0288cd77df486e72c677.css" integrity="sha512-IMuHhValMXKx9znnTWRI4neuXsQVIucsgcibxlD9rNrveZ5mHQiEsFeuTOL5ly00L1aF20MqAojNd99IbnLGdw=="> 

  
  
  
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
      <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
  

  
<link rel="icon" type="image/png" href="/images/favicon.ico" />

  
  
  
  
  
    
<script type="application/javascript">
var doNotTrack = false;
if (!doNotTrack) {
	window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;
	ga('create', 'G-X1L70M4MM0', 'auto');
	
	ga('send', 'pageview');
}
</script>
<script async src='https://www.google-analytics.com/analytics.js'></script>

  
  
</head>

<body class="max-width mx-auto px3 ltr">
  <div class="content index py4">

    <header id="header">
  <a href="/">
  
    <div id="logo" style="background-image: url(/images/logo.png)"></div>
  
  <div id="title">
    <h1>Y.CH.Y</h1>
  </div>
  </a>
  <div id="nav">
    <ul>
      <li class="icon">
        <a href="#" aria-label="Menu"><i class="fas fa-bars fa-2x" aria-hidden="true"></i></a>
      </li>
      
        <li><a href="/">首页</a></li>
      
        <li><a href="/about">关于</a></li>
      
    </ul>
  </div>
</header>



    
<article class="post" itemscope itemtype="http://schema.org/BlogPosting">

  <div class="content" itemprop="articleBody">
  
    <h2 id="设计谷歌硬盘">设计谷歌硬盘</h2>
<p>近年来，Google Drive、Dropbox、微软 OneDrive 和苹果 iCloud 等云存储服务已经变得非常流行。在本章中，你被要求设计 Google Drive。</p>
<p>在进入设计之前，让我们花点时间来了解一下 Google Drive。Google Drive 是一个文件存储和同步服务，帮助你在云端存储文档、照片、视频和其他文件。你可以从任何电脑、智能手机和平板电脑访问你的文件。你可以轻松地与朋友、家人和同事分享这些文件[1]。图 15-1 和 15-2 分别显示了谷歌硬盘在浏览器和移动应用程序上的样子。</p>
<img src="../../../system_design_interview/index-244_1.jpg" width="66%"/>
<img src="../../../system_design_interview/index-245_1.jpg" width="33%"/>
<h3 id="理解问题并确定设计范围">理解问题并确定设计范围</h3>
<p>设计谷歌硬盘是一个大项目，因此，提出问题以缩小范围是很重要的。</p>
<p>应聘者：最重要的功能是什么？<br>
面试官：上传和下载文件，文件同步，以及通知。<br>
应聘者：这是一个移动应用，一个网络应用，还是两者都有？<br>
面试官：都是。<br>
应聘者：支持的文件格式有哪些？<br>
面试官：任何文件类型。<br>
应聘者：文件是否需要加密？<br>
面试官：是的。是的，存储中的文件必须是加密的。<br>
应聘者：文件大小有限制吗？<br>
面试官：有，文件必须是 10GB 或更小。<br>
应聘者：该产品有多少用户？<br>
面试官：10M DAU。</p>
<p>在本章中，我们将重点介绍以下功能。</p>
<ul>
<li>添加文件。添加文件的最简单方法是将文件拖放到 Google Drive 中。</li>
<li>下载文件。</li>
<li>在多个设备上同步文件。当一个文件被添加到一个设备上时，它将自动同步到其他设备。</li>
<li>查看文件修订情况。</li>
<li>与你的朋友、家人和同事分享文件</li>
<li>当一个文件被编辑、删除或与你分享时，发送通知。本章未讨论的功能包括。</li>
<li>谷歌文档的编辑和协作。Google doc 允许多个人同时编辑同一个文件。这不在我们的设计范围之内。</li>
</ul>
<p>除了澄清需求之外，了解非功能需求也很重要。</p>
<ul>
<li>可靠性。可靠性对于一个存储系统是极其重要的。数据丢失是不可接受的。</li>
<li>快速的同步速度。如果文件同步需要太多时间，用户会变得不耐烦并放弃该产品。</li>
<li>带宽使用。如果一个产品需要大量不必要的网络带宽，用户就会不高兴，特别是当他们使用移动数据计划时。</li>
<li>可扩展性。系统应该能够处理大量的流量。</li>
<li>高可用性。当一些服务器离线、速度减慢或出现意外的网络错误时，用户仍应能使用该系统。</li>
</ul>
<h3 id="粗略估计">粗略估计</h3>
<ul>
<li>假设该应用程序有 5000 万注册用户和 1000 万 DAU。</li>
<li>用户得到 10GB 的免费空间。</li>
<li>假设用户每天上传 2 个文件。平均文件大小为 500KB。</li>
<li>读写比为 1:1。</li>
<li>分配的总空间。5000 万 * 10 GB = 500 Petabyte</li>
<li>上传 API 的 QPS：1000 万 * 2</li>
<li>峰值 QPS = QPS * 2 = 480</li>
</ul>
<h3 id="提出高水平的设计并获得认同">提出高水平的设计并获得认同</h3>
<p>我们不从一开始就展示高层次的设计图，而是采用一种稍微不同的方法。我们将从简单的东西开始：在一个单一的服务器中建立所有的东西。然后，逐渐扩大规模，支持数百万用户。通过做这个练习，它将刷新你对书中涉及的一些重要话题的记忆。</p>
<p>让我们从下面列出的单一服务器设置开始。</p>
<ul>
<li>一个网络服务器，用于上传和下载文件。</li>
<li>一个数据库，用于跟踪元数据，如用户数据、登录信息、文件信息等。</li>
<li>一个存储系统来存储文件。我们分配了 1TB 的存储空间来存储文件。</li>
</ul>
<p>我们花了几个小时建立一个 Apache 网络服务器，一个 MySql 数据库，以及一个名为 drive/的目录作为根目录来存储上传的文件。在 drive/目录下，有一个目录列表，被称为命名空间。每个命名空间包含该用户的所有上传文件。服务器上的文件名与原始文件名保持一致。每个文件或文件夹都可以通过加入命名空间和相对路径来唯一地识别。</p>
<p>图 15-3 显示了/drive 目录在左边的样子和它在右边的扩展视图的一个例子。</p>
<img src="../../../system_design_interview/index-248_1.jpg" width="66%"/>
  
  </div>
</article>


    <footer id="footer">
  <script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.2/MathJax.js?config=TeX-MML-AM_SVG"></script>
  <div class="footer-left">
    Copyright  &copy; 2021  Y.CH.Y 
    
    
  </div>
  <div class="footer-right">
    <nav>
      <ul>
         
        <li><a href="/">首页</a></li>
         
        <li><a href="/about">关于</a></li>
        
      </ul>
    </nav>
  </div>
</footer>


  </div>
</body>

<link rel="stylesheet" href=/lib/font-awesome/css/all.min.css>
<script src=/lib/jquery/jquery.min.js></script>
<script src=/js/main.js></script>
</html>
